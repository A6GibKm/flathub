{
    "app-id" : "org.gnome.FileRoller",
    "runtime" : "org.gnome.Platform",
    "runtime-version" : "3.36",
    "sdk" : "org.gnome.Sdk",
    "command" : "file-roller",
    "rename-icon": "org.gnome.ArchiveManager",
    "finish-args" : [
        "--share=ipc",
        "--socket=fallback-x11",
        "--socket=wayland",
        "--filesystem=home",
        "--talk-name=org.gtk.vfs",
        "--talk-name=org.gtk.vfs.*",
        "--filesystem=xdg-run/gvfs"
    ],
    "cleanup" : [
        "/share/man"
    ],
    "modules" : [
        {
            "name": "gcpio",
            "buildsystem": "autotools",
            "cleanup": [
                "/libexec",
                "/share/info",
                "/share/man"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/gnu/cpio/cpio-2.13.tar.gz",
                    "sha256": "e87470d9c984317f658567c03bfefb6b0c829ff17dbf6b0de48d71a4c8f3db88"
                }
            ]
        },
        {
            "name": "p7zip",
            "buildsystem": "simple",
            "build-commands": [
                "cp makefile.linux_amd64_asm makefile.machine",
                "make -j$FLATPAK_BUILDER_N_JOBS 7za",
                "install -Dm 755 bin/7za /app/bin/7za"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.sourceforge.net/project/p7zip/p7zip/16.02/p7zip_16.02_src_all.tar.bz2",
                    "sha256": "5eb20ac0e2944f6cb9c2d51dd6c4518941c185347d4089ea89087ffdd6e2341f"
                }
            ],
            "modules":
            [
                {
                    "name": "yasm",
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz",
                            "sha256": "3dce6601b495f5b3d45b59f7d2492a340ee7e84b5beca17e48f862502bd5603f"
                        }
                    ],
                    "cleanup": [
                        "*"
                    ]
                }
            ]
        },
        {
            "name": "unrar",
            "buildsystem": "simple",
            "build-commands": [
                "install -Dm755 apply_extra /app/bin/apply_extra"
            ],
            "sources": [
                {
                    "type": "extra-data",
                    "url": "https://www.rarlab.com/rar/rarlinux-x64-5.9.1.tar.gz",
                    "filename": "rarlinux-x64-5.9.1.tar.gz",
                    "sha256": "4eecb5f5f2cdd6b896bbbf5f98e718a672171f44fa9205f441aa6e6771ef2c06",
                    "size": 595595
                },
                {
                    "type": "script",
                    "dest-filename": "apply_extra",
                    "commands": [
                        "mkdir bin rar",
                        "tar --no-same-owner -xf rarlinux*.tar.gz rar/rar rar/unrar rar/license.txt",
                        "mv rar/* bin",
                        "rm -r rar",
                        "rm rarlinux*.tar.gz"
                    ]
                }
            ]
        },
        {
            "name" : "file-roller",
            "buildsystem" : "meson",
            "cleanup": [
                "org.gnome.FileRoller.ArchiveManager1.service"
            ],
            "sources" : [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/file-roller/3.36/file-roller-3.36.3.tar.xz",
                    "sha256": "0959e10a5d7a7442809624be9879d95db462ca76e8c66ad6299310e6acdb81b7"
                },
                {
                    "type" : "patch",
                    "path" : "appdata.patch"
                }
            ]
        }
    ]
}
